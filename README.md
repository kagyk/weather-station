# weather-station

## Назначение

Программа weather_station предназначена для отображения показания датчиков температуры и влажности и оповещения пользователя о достижение температуры и влажности критических отметок.  
Так же программа является тестовым задание.

## Аппаратные требования

Программа weather_station требует следующее аппаратное обеспечение:

1. процессор с архитектурой amd64 или x86 совместимый.
2. оперативная память 100 Мб.
3. место на жестком диске 1Мб

## Зависимости

Данные зависимости написаны для ОС Ubuntu 16. Для других версий Ubuntu названия пакетов могут отличатся.
Для работы программы необходимы следующие библиотеки:

1. libQt5Widgets - деб. пакет libqt5widgets5
2. libQt5Core - деб. пакет libqt5core5a
3. libstdc++ - деб. пакет libstdc++6
4. libgcc - деб. пакет gccgo-6
5. libc - деб.пакет libc6

Для сборки программы weather_station не обходимо:

1. cmake - version 3.5.1 (минимально)
2. GNU Make  - version 4.1 (минимально)
3. компилятор g++  -- version 5.4.0 (минимально)
4. git -version 2.7.4 (минимально)
5. Операционная система - Ubuntu 16 (минимально)
6. Qt - version 5.12.6

## Сборка программы weather_station

Для сборки программы weather_station необходимо выполнить следующие шаги:

1. Создайте директорию "build_prj" в своем домашнем каталоге, а затем перейдите в созданный каталог.  
   Для этого в консоли выполните команды:

   ```text

        mkdir -p  "$HOME/build_prj"
        cd "$HOME/build_prj"

   ```

2. Скачать проект программы с гит.  
   Для этого в консоли выполните команду:

    ```text

        git clone https://github.com/kagyk/weather-station.git

    ```

3. Зайдите в директорию weather-station.  
   Для этого в консоли выполните команду:

    ```text

        cd weather-station

    ```

4. Создайте каталог "build" для сборки проекта, а затем перейдите в созданный каталог.  
   Для этого в консоли выполните команды:

   ```text

        mkdir build
        cd build

    ```

5. Укажите префикс (CMAKE_PREFIX_PATH) - место расположение Qt5.  
    Для этого в консоли выполните команду:

    ```text

        export CMAKE_PREFIX_PATH="<путь к установленному Qt >"

        Пример : export CMAKE_PREFIX_PATH="/home/roman/Qt5.12.6/5.12.6/gcc_64"

    ```

6. Соберите проект.  
    Для этого в консоли выполните команды:

    ```text

        cmake ..
        make

    ```

## Состав программного обеспечения

1. weather_station - программа метеостанция
2. sensors.sh - программа подыгрыша, имитирует датчики влажности и температуры
3. config.xml - конфигурационный файл настроек лимитов температуры и влажности

## Запуск программы

Запуска программы - ./weather_station [options]

    Где: 

       --show                               - Запустить метеостанцию;
       --set-limit-temp <temp>              - Установить значение температуры, при превышение которой происходит оповещение пользователя
       --set-limit-hum <humidity>           - Установить значение влажности, при превышение которой происходит оповещение пользователя
       -s, --set-config-file <directory>    - Задать альтернативный путь к файлу настроек
       -h, --help                           - Отобразить помощь.
       -v, --version                        - Отобразить версию.

## Пример запуска программы

```text
        ./weather_station --show  -запустить метеостанцию

        ./weather_station --set-limit-temp 55 --set-limit-hum 95 - установить настройки максимальной температуры и влажности по достижение которых пользователю будут приходить уведомления.

        ./weather_station --help -отобразить помощь

        ./weather_station -v -отобразить версию приложения

        ./weather_station --show --set-config-file </path/to>  -запустить метеостанцию с указание альтернативного пути конфигурационного файла.
 
```

## Описание конфигурационного файла

По умолчанию конфигурационный файл находится в папке conf/config.xml.  
Наполнение конфигурационного файла:

```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <config>
        <max_temperature>2</max_temperature>
        <max_humidity>93</max_humidity>
    </config>

    где: max_temperature    - значение температуры, при превышение которой происходит оповещение пользователя;
         max_humidity       - значение влажности, при превышение которой происходит оповещение пользователя
```

## Описание протокола информационного взаимодействия между weather_station и sensors

Программа weather_station взаимодействует с программой sensors через именованные каналы (FIFO), расположенный в /tmp/weather_station.fifo.
Программа sensors - это программа для подыгрыша. Месторасположения программы script/sensors.sh
Программа sensors записывает данные в формате xml в FIFO для weather_station.

Формат данных:

```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <config>
        <temperature>2</max_temperature>
        <humidity>93</max_humidity>
    </config>

    где: temperature    - значение температуры, при превышение которой происходит оповещение пользователя;
         humidity       - значение влажности, при превышение которой происходит оповещение пользователя
```
